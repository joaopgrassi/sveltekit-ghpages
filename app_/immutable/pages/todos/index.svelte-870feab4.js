import{H,S as ae,i as ne,s as oe,e as E,k as D,c as q,a as N,m as I,d as k,b as o,M as X,g as Z,N as v,a1 as P,a2 as se,a3 as le,a4 as re,W as ie,Z as Y,G as de,t as ue,V as ce,h as he,a5 as _e,p as fe,q as me,o as pe,n as ve,a6 as be,E as ge}from"../../chunks/index-cc7dbd6b.js";import{c as ye,a as $}from"../../chunks/index-3b4730c1.js";function V(d,{pending:t,error:e,result:a}){let c;async function g(_){const u=c={};_.preventDefault();const b=new FormData(d);t&&t(b,d);try{const l=await fetch(d.action,{method:d.method,headers:{accept:"application/json"},body:b});if(u!==c)return;l.ok?a(l,d):e?e(l,null,d):console.error(await l.text())}catch(l){if(e)e(null,l,d);else throw l}}return d.addEventListener("submit",g),{destroy(){d.removeEventListener("submit",g)}}}function ke(d,{from:t,to:e},a={}){const c=getComputedStyle(d),g=c.transform==="none"?"":c.transform,[_,u]=c.transformOrigin.split(" ").map(parseFloat),b=t.left+t.width*_/e.width-(e.left+_),l=t.top+t.height*u/e.height-(e.top+u),{delay:n=0,duration:m=p=>Math.sqrt(p)*120,easing:h=ye}=a;return{delay:n,duration:H(m)?m(Math.sqrt(b*b+l*l)):m,easing:h,css:(p,w)=>{const j=w*b,T=w*l,s=p+w*t.width/e.width,i=p+w*t.height/e.height;return`transform: ${g} translate(${j}px, ${T}px) scale(${s}, ${i});`}}}function ee(d,t,e){const a=d.slice();return a[6]=t[e],a[7]=t,a[8]=e,a}function te(d,t){let e,a,c,g,_,u,b,l,n,m,h,p,w,j,T,s,i,r,M,R,F,B,L,U,A,G=ge,O,W,x;function z(...y){return t[3](t[6],t[7],t[8],...y)}function J(){return t[4](t[6],t[7],t[8])}function K(){return t[5](t[6])}return{key:d,first:null,c(){e=E("div"),a=E("form"),c=E("input"),_=D(),u=E("button"),m=D(),h=E("form"),p=E("input"),j=D(),T=E("button"),i=D(),r=E("form"),M=E("button"),L=D(),this.h()},l(y){e=q(y,"DIV",{class:!0});var f=N(e);a=q(f,"FORM",{action:!0,method:!0});var S=N(a);c=q(S,"INPUT",{type:!0,name:!0,class:!0}),_=I(S),u=q(S,"BUTTON",{class:!0,"aria-label":!0}),N(u).forEach(k),S.forEach(k),m=I(f),h=q(f,"FORM",{class:!0,action:!0,method:!0});var C=N(h);p=q(C,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),j=I(C),T=q(C,"BUTTON",{class:!0,"aria-label":!0}),N(T).forEach(k),C.forEach(k),i=I(f),r=q(f,"FORM",{action:!0,method:!0});var Q=N(r);M=q(Q,"BUTTON",{class:!0,"aria-label":!0}),N(M).forEach(k),Q.forEach(k),L=I(f),f.forEach(k),this.h()},h(){o(c,"type","hidden"),o(c,"name","done"),c.value=g=t[6].done?"":"true",o(c,"class","svelte-dmxqmd"),o(u,"class","toggle svelte-dmxqmd"),o(u,"aria-label",b="Mark todo as "+(t[6].done?"not done":"done")),o(a,"action",l="/todos/"+t[6].uid+".json?_method=patch"),o(a,"method","post"),o(p,"aria-label","Edit todo"),o(p,"type","text"),o(p,"name","text"),p.value=w=t[6].text,o(p,"class","svelte-dmxqmd"),o(T,"class","save svelte-dmxqmd"),o(T,"aria-label","Save todo"),o(h,"class","text svelte-dmxqmd"),o(h,"action",s="/todos/"+t[6].uid+".json?_method=patch"),o(h,"method","post"),o(M,"class","delete svelte-dmxqmd"),o(M,"aria-label","Delete todo"),M.disabled=R=t[6].pending_delete,o(r,"action",F="/todos/"+t[6].uid+".json?_method=delete"),o(r,"method","post"),o(e,"class","todo svelte-dmxqmd"),X(e,"done",t[6].done),this.first=e},m(y,f){Z(y,e,f),v(e,a),v(a,c),v(a,_),v(a,u),v(e,m),v(e,h),v(h,p),v(h,j),v(h,T),v(e,i),v(e,r),v(r,M),v(e,L),O=!0,W||(x=[P(n=V.call(null,a,{pending:z,result:t[1]})),P(V.call(null,h,{result:t[1]})),P(B=V.call(null,r,{pending:J,result:K}))],W=!0)},p(y,f){t=y,(!O||f&1&&g!==(g=t[6].done?"":"true"))&&(c.value=g),(!O||f&1&&b!==(b="Mark todo as "+(t[6].done?"not done":"done")))&&o(u,"aria-label",b),(!O||f&1&&l!==(l="/todos/"+t[6].uid+".json?_method=patch"))&&o(a,"action",l),n&&H(n.update)&&f&1&&n.update.call(null,{pending:z,result:t[1]}),(!O||f&1&&w!==(w=t[6].text)&&p.value!==w)&&(p.value=w),(!O||f&1&&s!==(s="/todos/"+t[6].uid+".json?_method=patch"))&&o(h,"action",s),(!O||f&1&&R!==(R=t[6].pending_delete))&&(M.disabled=R),(!O||f&1&&F!==(F="/todos/"+t[6].uid+".json?_method=delete"))&&o(r,"action",F),B&&H(B.update)&&f&1&&B.update.call(null,{pending:J,result:K}),f&1&&X(e,"done",t[6].done)},r(){A=e.getBoundingClientRect()},f(){se(e),G(),le(e,A)},a(){G(),G=re(e,A,ke,{duration:200})},i(y){O||(y&&ie(()=>{U||(U=Y(e,$,{start:.7},!0)),U.run(1)}),O=!0)},o(y){y&&(U||(U=Y(e,$,{start:.7},!1)),U.run(0)),O=!1},d(y){y&&k(e),y&&U&&U.end(),W=!1,de(x)}}}function we(d){let t,e,a,c,g,_,u,b,l,n=[],m=new Map,h,p,w,j=d[0];const T=s=>s[6].uid;for(let s=0;s<j.length;s+=1){let i=ee(d,j,s),r=T(i);m.set(r,n[s]=te(r,i))}return{c(){t=D(),e=E("div"),a=E("h1"),c=ue("Todos"),g=D(),_=E("form"),u=E("input"),l=D();for(let s=0;s<n.length;s+=1)n[s].c();this.h()},l(s){ce('[data-svelte="svelte-181o7gf"]',document.head).forEach(k),t=I(s),e=q(s,"DIV",{class:!0});var r=N(e);a=q(r,"H1",{});var M=N(a);c=he(M,"Todos"),M.forEach(k),g=I(r),_=q(r,"FORM",{class:!0,action:!0,method:!0});var R=N(_);u=q(R,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),R.forEach(k),l=I(r);for(let F=0;F<n.length;F+=1)n[F].l(r);r.forEach(k),this.h()},h(){document.title="Todos",o(u,"name","text"),o(u,"aria-label","Add todo"),o(u,"placeholder","+ tap to add a todo"),o(u,"class","svelte-dmxqmd"),o(_,"class","new svelte-dmxqmd"),o(_,"action","/todos.json"),o(_,"method","post"),o(e,"class","todos svelte-dmxqmd")},m(s,i){Z(s,t,i),Z(s,e,i),v(e,a),v(a,c),v(e,g),v(e,_),v(_,u),v(e,l);for(let r=0;r<n.length;r+=1)n[r].m(e,null);h=!0,p||(w=P(b=V.call(null,_,{result:d[2]})),p=!0)},p(s,[i]){if(b&&H(b.update)&&i&1&&b.update.call(null,{result:s[2]}),i&3){j=s[0],ve();for(let r=0;r<n.length;r+=1)n[r].r();n=_e(n,i,T,1,s,j,m,e,be,te,null,ee);for(let r=0;r<n.length;r+=1)n[r].a();fe()}},i(s){if(!h){for(let i=0;i<j.length;i+=1)me(n[i]);h=!0}},o(s){for(let i=0;i<n.length;i+=1)pe(n[i]);h=!1},d(s){s&&k(t),s&&k(e);for(let i=0;i<n.length;i+=1)n[i].d();p=!1,w()}}}const Te=async({fetch:d})=>{const t=await d("/todos.json");if(t.ok)return{props:{todos:await t.json()}};const{message:e}=await t.json();return{error:new Error(e)}};function Ee(d,t,e){let{todos:a}=t;async function c(l){const n=await l.json();e(0,a=a.map(m=>m.uid===n.uid?n:m))}const g=async(l,n)=>{const m=await l.json();e(0,a=[...a,m]),n.reset()},_=(l,n,m,h)=>{e(0,n[m].done=!!h.get("done"),a)},u=(l,n,m)=>e(0,n[m].pending_delete=!0,a),b=l=>{e(0,a=a.filter(n=>n.uid!==l.uid))};return d.$$set=l=>{"todos"in l&&e(0,a=l.todos)},[a,c,g,_,u,b]}class Me extends ae{constructor(t){super(),ne(this,t,Ee,we,oe,{todos:0})}}export{Me as default,Te as load};
